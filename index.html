<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Questionnaire</title>
</head>

<body>
  <h1>Questionnaire</h1>
  <form id="mcqForm">
    <label for="name">Crossing Name:</label>
    <input type="text" id="name" name="name" required>
    <br><br>

    <h2>Questions:</h2>

    <!-- Question 1 -->
    <div>
      <p>1) ক্রসিং এ রোডের এপ্রোচ কয়টা?</p>
      <input type="radio" name="q1" value="1" required> a) 3<br>
      <input type="radio" name="q1" value="2"> b) 4<br>
      <input type="radio" name="q1" value="3"> c) 5<br>
      <input type="radio" name="q1" value="4"> d) 6<br>
    </div>
    <!-- Question 16 -->
    <div>
      <p>16) টোটাল লেনের সংখ্যা কত?</p>
      <select id="q16" name="q16" required>
        <option value="">-- Select --</option>
      </select>
    </div>
    <!-- Question 13 -->
    <div>
      <p>13) ফুটপাতের সংখ্যা কয়টি?</p>
      <select id="q13" name="q13" required>
        <option value="">-- Select --</option>
      </select>
    </div>
    <!-- Question 2 -->
    <div>
      <p>2) জেব্রা ক্রসিং দেখা যায় ?</p>
      <input type="radio" name="q2" value="1" required> a) এক টাতেও নাই<br>
      <input type="radio" name="q2" value="2"> b) ১ টায় আছে<br>
      <input type="radio" name="q2" value="3"> c) ২ টায় আছে<br>
      <input type="radio" name="q2" value="4"> d) ৩ টায় আছে<br>
      <input type="radio" name="q2" value="5"> e) ৪ টায় আছে<br>
      <input type="radio" name="q2" value="6"> f) ৫ টায় আছে<br>
    </div>

    <!-- Question 3 -->
    <div>
      <p>3) স্পিড ব্রেকার দেখা যায় ?</p>
      <input type="radio" name="q3" value="1" required> a) এক টাতেও নাই<br>
      <input type="radio" name="q3" value="2"> b) ১ টায় আছে<br>
      <input type="radio" name="q3" value="3"> c) ২ টায় আছে<br>
      <input type="radio" name="q3" value="4"> d) ৩ টায় আছে<br>
      <input type="radio" name="q3" value="5"> e) ৪ টায় আছে<br>
      <input type="radio" name="q3" value="6"> f) ৫ টায় আছে<br>
    </div>

    <!-- Question 4 -->
    <div>
      <p>4) পেডিস্ট্রিয়ান আইল্যান্ড দেখা যায় ?</p>
      <input type="radio" name="q4" value="1" required> a) এক টাতেও নাই<br>
      <input type="radio" name="q4" value="2"> b) ১ টায় আছে<br>
      <input type="radio" name="q4" value="3"> c) ২ টায় আছে<br>
      <input type="radio" name="q4" value="4"> d) ৩ টায় আছে<br>
      <input type="radio" name="q4" value="5"> e) ৪ টায় আছে<br>
      <input type="radio" name="q4" value="6"> f) ৫ টায় আছে<br>
    </div>

    <!-- Question 5 -->
    <div>
      <p>5) ভিজিবিলিটি কেমন?</p>
      <input type="radio" name="q5" value="1" required> a) চারিদিক থেকে আসা গাড়ি দেখা যায়<br>
      <input type="radio" name="q5" value="2"> b) ব্লাইন্ড স্পট রয়েছে<br>
    </div>

    <!-- Question 6 -->
    <div>
      <p>6) পথচারীর জন্য নির্দেশনা আছে?</p>
      <input type="radio" name="q6" value="1" required> a) হ্যাঁ<br>
      <input type="radio" name="q6" value="2"> b) না<br>
    </div>

    <!-- Question 7 -->
    <div>
      <p>7) ফুট ওভার ব্রিজ আছে?</p>
      <input type="radio" name="q7" value="1" required> a) হ্যাঁ<br>
      <input type="radio" name="q7" value="2"> b) না<br>
    </div>

    <!-- Question 8 -->
    <div>
      <p>8) ফুটপাতের অবস্হা কেমন?</p>
      <input type="radio" name="q8" value="1" required> a) পর্যাপ্ত আছে<br>
      <input type="radio" name="q8" value="2"> b) পর্যাপ্ত আছে কিন্তু হকারদের দখলে<br>
      <input type="radio" name="q8" value="3"> c) আছে তবে পর্যাপ্ত না ও হকারদের দখলে<br>
      <input type="radio" name="q8" value="4"> d) আছে তবে পর্যাপ্ত না ও হকার নেই<br>
      <input type="radio" name="q8" value="5"> e) নেই<br>
    </div>

    <!-- Question 9 -->
    <div>
      <p>9) ফুটপাতে রেলিং দেয়া আছে?</p>
      <input type="radio" name="q9" value="1" required> a) হ্যাঁ<br>
      <input type="radio" name="q9" value="2"> b) না<br>
    </div>

    <!-- Question 10 -->
    <div>
      <p>10) ট্রাফিক কন্ট্রোল কেমন?</p>
      <input type="radio" name="q10" value="1" required> a) ট্রাফিক লাইট কন্ট্রোল<br>
      <input type="radio" name="q10" value="2"> b) পুলিশ কন্ট্রোল<br>
      <input type="radio" name="q10" value="3"> c) কোন কন্ট্রোল নাই<br>
    </div>

    <!-- Question 11 -->
    <div>
      <p>11) রোড মারকিং দেখা যায়?</p>
      <input type="radio" name="q11" value="1" required> a) সব গুলোয় আছে + Visible<br>
      <input type="radio" name="q11" value="2"> b) সব গুলোয় আছে + Visible Low<br>
      <input type="radio" name="q11" value="3"> c) কয়েকটা রোডে আছে + Visible<br>
      <input type="radio" name="q11" value="4"> d) কয়েকটা রোডে আছে + Visibility Low<br>
      <input type="radio" name="q11" value="5"> e) একদম নাই<br>
    </div>

    <!-- Question 12 -->
    <div>
      <p>12) পথচারী পার হবার জন্য কি আলাদা সময় আছে?</p>
      <input type="radio" name="q12" value="1" required> a) হ্যাঁ<br>
      <input type="radio" name="q12" value="2"> b) না<br>
    </div>



    <!-- Question 14 -->
    <div>
      <p>14) ফুটপাতে রেলিং আছে কয়টিতে?</p>
      <select id="q14" name="q14" required>
        <option value="">-- Select --</option>
      </select>
    </div>

    <!-- Question 15 -->
    <div>
      <p>15) ফুট ওভারব্রিজ কয়টি?</p>
      <select id="q15" name="q15" required>
        <option value="">-- Select --</option>
      </select>
    </div>


    <button type="button" onclick="downloadExcel()">Submit</button>
  </form>

  <script>
    // Dynamically populate dropdowns
    const populateDropdown = (id, options) => {
      const dropdown = document.getElementById(id);
      options.forEach(option => {
        const opt = document.createElement('option');
        opt.value = option;
        opt.textContent = option;
        dropdown.appendChild(opt);
      });
    };

    // Populate dropdown options
    populateDropdown('q13', Array.from({ length: 15 }, (_, i) => i));
    populateDropdown('q14', Array.from({ length: 15 }, (_, i) => i));
    populateDropdown('q15', Array.from({ length: 9 }, (_, i) => i));
    populateDropdown('q16', [4, 6, 8, 10, 12, 14, 16, 18, 20, 22, 24]);

    function downloadExcel() {
      const name = document.getElementById('name').value.trim();
      if (!name) {
        alert('Please enter the crossing name!');
        return;
      }

      const questions = document.querySelectorAll('[name^="q"]');
      const answers = Array.from(questions).reduce((acc, question) => {
        if (question.type === 'radio' && question.checked) acc[question.name] = question.value;
        if (question.type === 'select-one' && question.value !== '') acc[question.name] = question.value;
        return acc;
      }, {});

      // Validate if all questions have answers
      if (Object.keys(answers).length !== 16) {
        alert('Please answer all questions!');
        return;
      }

      // Prepare CSV data
      const data = [
        ['Name', ...Object.keys(answers)],
        [name, ...Object.values(answers)],
      ];

      const csvContent = data.map(row => row.join(',')).join('\n');
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);

      const link = document.createElement('a');
      link.href = url;
      link.download = `${name}_answers.csv`;
      link.style.display = 'none';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);

      URL.revokeObjectURL(url);
    }
  </script>
</body>

</html>